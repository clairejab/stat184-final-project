---
title: "Stat184 Final Project "
output: html_notebook
---
```{r} 
library(DataComputing)
library(tidyr)
library(mosaicData)
library(rvest)
library(dbplyr)
library(dplyr)
library(tidyverse)
```
My final projects involves investigating a set of Thanksgiving 2015 data. Participants were asked 23 questions about their Thanksgiving celebrations & traditions, Thanksgiving festivities including Black Friday plans, and who they are as people. From exploring and manipulating the data, I was able to learn more about all respondents and draw conconclusions about groups of people.

```{r}
myURL <- "/Users/clairejablonski/Downloads/data-master/thanksgiving-2015/thanksgiving-2015-poll-data.csv"
ThanksgivingData <- read.csv(myURL) # Reading Thanksgiving Data with read.csv()
```

I began by renaming variables and removing variables that were not needed. I created a new data table called TidyThanksgiving which presented the data with nicer variable names. 
```{r}
TidyThanksgivingData <-
  ThanksgivingData %>%
  rename(Respondent = RespondentID, CelebrateThanksgiving = Do.you.celebrate.Thanksgiving., MainDish = What.is.typically.the.main.dish.at.your.Thanksgiving.dinner., MainDishCooked = How.is.the.main.dish.typically.cooked., TypeofStuffing = What.kind.of.stuffing.dressing.do.you.typically.have., TypeofCranberrySauce = What.type.of.cranberry.saucedo.you.typically.have., Gravy = Do.you.typically.have.gravy., PrayatMeal = Do.you.typically.pray.before.or.after.the.Thanksgiving.meal., TravelDistance = How.far.will.you.travel.for.Thanksgiving., WatchMacysParade = Will.you.watch.any.of.the.following.programs.on.Thanksgiving..Please.select.all.that.apply....Macy.s.Parade, KidsTableAgeCutoff = What.s.the.age.cutoff.at.your..kids..table..at.Thanksgiving., Sex = What.is.your.gender., HouseholdCombinedSalary = How.much.total.combined.money.did.all.members.of.your.HOUSEHOLD.earn.last.year., LivingArea = How.would.you.describe.where.you.live. ) %>%
  select(-How.is.the.main.dish.typically.cooked....Other..please.specify., -What.kind.of.stuffing.dressing.do.you.typically.have....Other..please.specify., -What.type.of.cranberry.saucedo.you.typically.have....Other..please.specify., -Which.of.these.side.dishes.aretypically.served.at.your.Thanksgiving.dinner..Please.select.all.that.apply....Other..please.specify..1, -Which.of.these.side.dishes.aretypically.served.at.your.Thanksgiving.dinner..Please.select.all.that.apply....Other..please.specify., -Which.type.of.pie.is.typically.served.at.your.Thanksgiving.dinner..Please.select.all.that.apply....Other..please.specify., -Which.type.of.pie.is.typically.served.at.your.Thanksgiving.dinner..Please.select.all.that.apply....Other..please.specify..1, -Which.of.these.desserts.do.you.typically.have.at.Thanksgiving.dinner..Please.select.all.that.apply......Other..please.specify., -Which.of.these.desserts.do.you.typically.have.at.Thanksgiving.dinner..Please.select.all.that.apply......Other..please.specify..1)



head(TidyThanksgivingData) # head() was used to show a snapshot of the data table
```


After creating a tidy data table, I wanted to know exactly how many of the responents celebrate Thanksgiving. To do this, I filtered out those that do celebrate Thanksgiving and found that 980 out of the 1058 people celebrate Thanksgiving. 
```{r}
TidyThanksgivingData %>%
  filter(CelebrateThanksgiving == "Yes") %>%
  summarise(total = n())
```

Next, I was interested in how many females and males responded to this survey.Grouping by sex shows that there were 544 women who completed the survey and 481 males that completed the survey. 33 people choose not to record their sex and have been removed from the information provided below. 
```{r}
TidyThanksgivingData %>%
  group_by(Sex) %>%
  filter(Sex != "") %>% # Removes anyone who did not list their sex 
  summarise(total = n())

```


A data table called "Celebrate" was created showing the split between females and males and their age group ranges who celebrate Thanksgiving. It is interesting to see that females 60+ celebrate Thanksgiving the most with a total of 144 people celebrating. Males aged 45-59 celebrate Thanksgiving the most with 127 people celebrating. It is not suprising that there are more females that celebrate Thanksgiving in each category. There are way more females that completed the survey than males. The graph is a good visualization for showing the differences between females and males of the four age ranges that celebrate Thanksgiving. The biggest difference between the number of females and males that celebrate Thanksgiving is for 60+ people. The smallest difference between the number of females and males that celebrate Thanksgiving is for the people between 45 to 59 age range.
```{r}
Celebrate <-
  TidyThanksgivingData %>%
  filter(CelebrateThanksgiving =="Yes") %>%
  filter(Sex != "")%>%
  group_by(Sex,Age) %>%
  summarise(total = n())
  
Celebrate %>%
  ggplot(aes(x= Age, y=total)) +
  geom_point(aes(color = Sex))
```


Grouping by where people live and if they celebrate Thanksgiving helps to show us that most people that celebrate Thanksgiving live in the Suburbs. This number is double Rural and Urban numbers.
```{r}
TidyThanksgivingData %>%
  group_by(LivingArea, CelebrateThanksgiving) %>%
  filter(LivingArea != "") %>%
  summarise(total = n())
```


A new data table called "RetailSalary" was created to compare people who work in retail and who don't work and retail to what their household combined salaries were. The graph below shows that more people did not work in retail than did work in retail. The graph also shows that people who did not work in retail had higher household combined salaries. 
```{r}
RetailSalary <-
  TidyThanksgivingData %>%
  group_by(Do.you.work.in.retail.,HouseholdCombinedSalary ) %>%
  filter(Do.you.work.in.retail. != "") %>%
  filter(HouseholdCombinedSalary != "", HouseholdCombinedSalary != "Prefer not to answer") %>%
  summarise(total = n())


RetailSalary %>%
  ggplot(aes(x = HouseholdCombinedSalary, y = total)) +
  geom_point(aes( color = Do.you.work.in.retail.))
```


From this data table called "USRegionMainDish" we are looking at what different regions people live in, what is the main dish they eat for Thanksgiving and how is this main dish cooked. From the table we can see that the most amount of people live in the South Atlantic and bake turkey.
```{r}
USRegionMainDish <-
  TidyThanksgivingData %>%
  group_by(US.Region, MainDish, MainDishCooked) %>%
  filter(US.Region != "") %>%
  filter(MainDish !="Other (please specify)") %>%
  filter(MainDish != "") %>%
  filter(MainDish != "I don't know") %>%
  filter(MainDishCooked !="Other (please specify)") %>%
  filter(MainDishCooked != "I don't know") %>%
  summarise(total = n())

USRegionMainDish %>%
  arrange( desc(total))

USRegionMainDish %>%
  ggplot(aes(x = MainDish , y = total )) +
  geom_point( aes(shape = MainDishCooked)) +
  facet_wrap( ~ US.Region)

```
From this graph it is now obvious that in each region that turkey is more served than anyother dish. What we cannot really tell from this graph is the way that most people cook their main dish it really varies from region to region and there is no distinct pattern seen from it. Other factors may have an influenece like age, sex, or income. Let us explore what age has to do with the style in how people cook their turkey. 
```{r}
USRegionMainDish %>%
  filter(MainDish == "Turkey" ) %>%
  ggplot(aes(x = MainDishCooked , y = total )) +
  geom_point(aes(color = US.Region))
  
```
From this graph we get a better visaulization with color seeing the split in the amount of people in each region that either baked, fried, or roasted their turkey. We can see that all 9 US Regions bake their turkey while only 6 US Regions fry their turkey and 8 regions roast their turkey. It is obvious to tell from this graph that frying turkey is the least popular choice among all regions. West North Centeral is the only US Region that does not roast their turkey. It is very close for all other US regions between the amount of people that bake their turkey or roast it. It is interesting to note that there is larger spread between the regions in who bakes their turky compared to the more compact spread of those that roast their turkey. 




```{r}
TidyThanksgivingData %>%
  group_by(Age, MainDishCooked) %>%
  summarise(total = n()) %>%
  filter(MainDishCooked !="", MainDishCooked != "Other (please specify)", MainDishCooked != "I don't know", Age != "") %>%
  arrange( desc(total) )
```
This shows that Baked and Roasted are the most popular cooking type for the main dish. It is important to notice that the older range of people are the most popular in these types more than younger people because from what we saw before in the data it makes sense because there are more older people that complete this survey that celebrate thanksgiving compred to younger generations of people.


```{r}
HouseholdSalary <-
  TidyThanksgivingData %>%
  mutate( HouseholdCombinedSalary=gsub("[$,%]|to|and up","",HouseholdCombinedSalary)) %>%
  mutate( Age=gsub("[-, 29, 44, +]","", Age)) %>%
  mutate(Age = as.numeric(Age)) %>%
  mutate(Salary=if_else(condition = (HouseholdCombinedSalary == "Prefer not answer"), true = as.character(NA), false = str_extract(string = HouseholdCombinedSalary, pattern = "^[[:digit:]]+" ))) %>%
  mutate(Salary = as.numeric(Salary))


```



```{r}
HouseholdSalary %>%
  filter(Age != "") %>%
  mean(Age)
```

Looking at the dataset "HouseholdSalary", it is interesting to see that for most age ranges in different living areas that most people do not go Black Friday shopping. Those that are 18 years old go Black Friday shopping the most and live in the suburbs.
```{r}
HouseholdSalary %>%
  group_by(Age, Will.you.shop.any.Black.Friday.sales.on.Thanksgiving.Day., LivingArea) %>%
  filter(Age != "", Will.you.shop.any.Black.Friday.sales.on.Thanksgiving.Day. != "", LivingArea != "") %>%
  summarise(total = n()) %>%
arrange( desc(total) )

```

```{r}
MainDishServed <-
  TidyThanksgivingData %>%
  BP_narrow %>%
  mutate(change= MainDish - What.is.typically.the.main.dish.at.your.Thanksgiving.dinner....Other..please.specify.)
  
```


```{r}
PrayBeforeMeal <-
TidyThanksgivingData %>%
  group_by(PrayatMeal, Sex) %>%
  filter(PrayatMeal != "") %>%
  filter(Sex != "") %>%
  summarise(total = n())

PrayBeforeMeal %>%
  arrange( desc(total))
```

```{r}
PrayBeforeMeal %>%
  ggplot(aes( x = PrayatMeal, y= total)) +
  geom_point(aes(shape = Sex))
```

```{r}
PrayBeforeMeal <- matrix(c(174,152,341,280) ,nrow=2,byrow=TRUE)
PrayBeforeMeal
```

```{r}
dimnames(PrayBeforeMeal) <- list(c("No","Yes"),c("Female","Male"))
names(dimnames(PrayBeforeMeal)) <- c("Pray","Gender")
PrayBeforeMeal
```

```{r}
tot <- sum(PrayBeforeMeal)
tot

PrayBeforeMeal/tot
```

```{r}
prop.test(PrayBeforeMeal, correct = F)
```





```{r}
KidsTableCutoff <-
  TidyThanksgivingData %>%
  mutate( KidsTableAgeCutoff=gsub("or|younger|older","", KidsTableAgeCutoff)) %>%
  mutate( Age=gsub("[-, 29, 44, +]","", Age))
```

```{r}
KidsTableCutoff %>%
  filter(KidsTableAgeCutoff != "") %>%
  filter(Age != "") %>%
  filter(LivingArea != "") %>%
  ggplot(aes(x= Age, y = KidsTableAgeCutoff)) +
  geom_jitter(width = 0.3, height = 0.3) +
  facet_wrap( ~LivingArea)
  

```

```{r}
KidsTableCutoff %>%
  group_by(Age) %>%
  filter(Age != "") %>%
  summarise(Total = n())
  ggplot(aes(x= Age, y = Total)) +
  geom_bar()
```