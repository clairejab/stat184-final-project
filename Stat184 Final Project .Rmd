---
title: "Stat184 Final Project "
output: html_notebook
---
```{r} 
library(DataComputing)
library(tidyr)
library(mosaicData)
library(rvest)
library(dbplyr)
```

```{r}
myURL <- "/Users/clairejablonski/Downloads/data-master/thanksgiving-2015/thanksgiving-2015-poll-data.csv"
ThanksgivingData <- read.csv(myURL)
```

Renaming variables so it is easier to understand data table.Preview of new data table called TidyThanksgiving Data which has updated headings.
```{r}
TidyThanksgivingData <-
  ThanksgivingData %>%
  rename(Respondent = RespondentID, CelebrateThanksgiving = Do.you.celebrate.Thanksgiving., MainDish = What.is.typically.the.main.dish.at.your.Thanksgiving.dinner., MainDishCooked = How.is.the.main.dish.typically.cooked., TypeofStuffing = What.kind.of.stuffing.dressing.do.you.typically.have., TypeofCranberrySauce = What.type.of.cranberry.saucedo.you.typically.have., Gravy = Do.you.typically.have.gravy., PrayatMeal = Do.you.typically.pray.before.or.after.the.Thanksgiving.meal., TravelDistance = How.far.will.you.travel.for.Thanksgiving., WatchMacysParade = Will.you.watch.any.of.the.following.programs.on.Thanksgiving..Please.select.all.that.apply....Macy.s.Parade, KidsTableAgeCutoff = What.s.the.age.cutoff.at.your..kids..table..at.Thanksgiving., Sex = What.is.your.gender., HouseholdCombinedSalary = How.much.total.combined.money.did.all.members.of.your.HOUSEHOLD.earn.last.year., LivingArea = How.would.you.describe.where.you.live. )

head(TidyThanksgivingData)
```


Filtering out "CelebrateThanksgiving" tells us that out of the 1058 cases (also known as saying out of the 1058 people that completed this survey) 980 of the people celebrated Thanksgiving in 2015.
```{r}
TidyThanksgivingData %>%
  filter(CelebrateThanksgiving == "Yes") %>%
  summarise(total = n())
```


Grouping by sex shows that there were 544 women who completed the survey and 481 males that completed the survey. The 33 number that has no category shows people who may have fogotten to fill out gender or those who did not feel the need to share their gender.
```{r}
TidyThanksgivingData %>%
  group_by(Sex) %>%
  filter(Sex != "") %>%
  summarise(total = n())

```


A data table called "Celebrate" was created showing the split between females and males and their age group ranges who celebrate Thanksgiving. It is interesting to see that females 60+ celebrate Thanksgiving the most with a total of 144 people celebrating. Males aged 45-59 celebrate Thanksgiving the most with 127 people celebrating. 
```{r}
Celebrate <-
  TidyThanksgivingData %>%
  filter(CelebrateThanksgiving =="Yes") %>%
  filter(Sex != "")%>%
  group_by(Sex,Age) %>%
  summarise(total = n())
  
Celebrate %>%
  ggplot(aes(x= Age, y=total)) +
  geom_point(aes(color = Sex))
```


Grouping by where people live and if they celebrate Thanksgiving helps to show us that most people that celebrate Thanksgiving live in the Suburbs. This number is double Rural and Urban numbers.
```{r}
TidyThanksgivingData %>%
  group_by(LivingArea, CelebrateThanksgiving) %>%
  filter(LivingArea != "") %>%
  summarise(total = n())
```



```{r}
RetailSalary <-
  TidyThanksgivingData %>%
  group_by(Do.you.work.in.retail.,HouseholdCombinedSalary ) %>%
  filter(Do.you.work.in.retail. != "") %>%
  filter(HouseholdCombinedSalary != "") %>%
  summarise(total = n())


RetailSalary %>%
  ggplot(aes(x = HouseholdCombinedSalary, y = total)) +
  geom_point(aes( color = Do.you.work.in.retail.))
```


